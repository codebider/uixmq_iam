import {User} from "domain/user/User";
import {UnauthorizationException, InvalidArgumentException} from "domain/Exception";

export const Authorization = {
    // Middleware authorization
    isAdmin: (req: any, res: any, next: () => void) => {
        if(!req.user.isAdmin()) throw new UnauthorizationException('', "Unauthorization.isAdmin");
        next();
    },

    isUser: (req: any, res: any, next: () => void ) =>  {
        if(!req.user.isUser()) throw new UnauthorizationException('', "Unauthorization.isUser");
        next();
    }
}
