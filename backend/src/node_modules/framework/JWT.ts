/* tslint:disable */

const jwt = require('jsonwebtoken');
import WaitFor from "framework/WaitFor";

export function MakeJWT(wait?: any) {
    return new JWT(wait || WaitFor);
}

export class JWT {

    private key = 'calendar@123#456$789#100DANIEL';
    private wait: any;
    
    constructor (wait: any) {
        this.wait = wait;
    }

    public encode(data) {
        return jwt.sign(data, this.key);
    }

    public decode(token) {
        return this.wait(new Promise((resolve, reject) => {
            jwt.verify(token, this.key, function(err, decoded) {
                if(err) {
                    resolve({error: err})
                }else{
                    resolve(decoded);
                }
            });
        }))
    }
}
